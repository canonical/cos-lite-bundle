# Kubernetes-type checks
command:
  {{ if .Vars.enable_k8s_tests }}
  pod-status-healthy:
    exec: kubectl get pods -n {{ .Vars.model_name }} --output=json
    exit-status: 0
    stdout:
      gjson:
        items.#.status.conditions.#.status|@flatten:
          not:
            - "False"
    stderr: ""

  pod-container-healthy:
    exec: kubectl get pods -n {{ .Vars.model_name }} --output=json 
    exit-status: 0
    stdout:
      gjson:
        items.#.status.containerStatuses.#.ready:
          not:
            - "false"
    stderr: ""
  {{ end }}
