command:
  validate-model-configuration:
    exec: juju status --format=json -m cos-model
    exit-status: 0
    stdout:
      gjson:
        applications:
          and:
            - {have-key: alertmanager}
            - {have-key: catalogue}
            - {have-key: grafana}
            - {have-key: loki}
            - {have-key: prometheus}
            - {have-key: traefik}
        applications.prometheus.relations:
          and:
            - {have-key: alertmanager}
            - {have-key: catalogue}
            - {have-key: grafana-dashboard}
            - {have-key: grafana-source}
            - {have-key: ingress}
            - {have-key: metrics-endpoint}
        applications.alertmanager.relations:
          and:
            - {have-key: alerting}
            - {have-key: catalogue}
            - {have-key: grafana-dashboard}
            - {have-key: grafana-source}
            - {have-key: ingress}
            - {have-key: replicas}
            - {have-key: self-metrics-endpoint}
        applications.alertmanager.relations.alerting.#.related-application:
          equal: [loki, prometheus]
    stderr: ""
